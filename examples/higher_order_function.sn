typedef List a = 
  Nil
| Cons of a * (List a)

let rec map f l =
  match l with
    Nil -> Nil
  | Cons(x,xs) -> Cons(f x,map f xs)

let map_id = map (fun x -> x) (Cons(1,Cons(2,Cons(3,Nil))))

let head l def =
  match l with
    Nil -> def
  | Cons(x,xs) -> x

let main = head map_id 5